name: Protein Clustering Analysis
description: Cluster proteins by product names with LLM-generated summary
estimated_time: 60.0
class: ClusteringStep
step_type: simple
enable_logging: true
debug_mode: true

# Data directory configuration - configurable paths for data storage and caching
data_directory: "data"  # Base data directory
mmseqs2_cache_directory: "data/mmseqs2_cache"  # MMseqs2 cache directory
cache_directory: "data/cache"  # General cache directory

# Clustering configuration
clustering_config:
  method: product_based  # Default method
  use_canonical_names: true  # Use canonical names from synonym processing
  canonical_name_field: "canonical_product"
  fallback_field: "product"  # Fallback if canonical name not available
  
  # Product-based clustering parameters
  similarity_threshold: 0.9
  min_cluster_size: 2
  max_cluster_size: 1000
  
  # LLM summary configuration
  enable_llm_summary: true
  summary_format: "markdown"
  max_clusters_to_display: 20
  include_sequence_snippets: true
  snippet_length: 100
  
  # Optional MMseqs2 parameters (if sequence-based clustering is enabled)
  mmseqs2_params:
    min_seq_id: 0.9
    coverage: 0.8
    coverage_mode: 0
    cluster_mode: 0
    fallback_to_mmseqs2: false

# Optional tool configuration (if sequence-based clustering needed)
tools:
  mmseqs2_tool:
    class: nanobrain.library.tools.bioinformatics.mmseqs2_tool.MMseqs2Tool
    config_file: ../../tools/mmseqs2_tool.yml
    enabled: false  # Product-based clustering is default
    tool_config:
      clustering_threshold: 0.8
      sensitivity: 7.5
      coverage: 0.9

# UPDATED: Input configuration with class field
input_configs:
  curated_sequences:
    class: nanobrain.core.data_unit.DataUnitMemory
    name: curated_sequences
    description: "Curated sequences from curation step"
    persistent: false

# UPDATED: Output configuration with class field
output_config:
  class: nanobrain.core.data_unit.DataUnitFile
  name: sequence_clusters
  description: "Protein clustering results"
  persistent: true
  file_path: "data/clustering_cache/clusters.json"

logical_steps_covered: [10]
step_description_detailed: 'Final clustering step with synonym-aware processing'

_metadata:
  last_updated: '2025-01-28'
  updated_by: 'synonym_agent_integration'
  migration_version: 2.0.0
  uses_modular_config: true
  uses_canonical_names: true
  config_type: "step"
  framework_version: "1.0.0"
  compliance_level: "full"
  tool_integration: "from_config"
